<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.2">
<title>Maritime Cloud Developer Guide 0.3-RC1</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove the comments around the @import statement below when using this as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
#map_canvas img,#map_canvas embed,#map_canvas object,.map_canvas img,.map_canvas embed,.map_canvas object{max-width:none!important}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
.antialiased,body{-webkit-font-smoothing:antialiased}
img{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{display:inline-block;color:rgba(0,0,0,.8);font-size:.75em;line-height:1.4;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:-.15em .15em 0 .15em;padding:.2em .6em .2em .5em;vertical-align:middle;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.05em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.spread{width:100%}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1{padding-right:.75em;font-weight:bold}
td.hdlist1,td.hdlist2{vertical-align:top}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none}
span.footnote,span.footnoteref{vertical-align:super;font-size:.875em}
span.footnote a,span.footnoteref a{text-decoration:none}
span.footnote a:active,span.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em;line-height:1.3;font-size:.875em;margin-left:1.2em;text-indent:-1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
h1,h2{letter-spacing:-.01em}
dt,th.tableblock,td.content{text-rendering:optimizeLegibility}
p,td.content{letter-spacing:-.01em}
p strong,td.content strong{letter-spacing:-.005em}
p,blockquote,dt,td.content{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img{page-break-inside:avoid}
thead{display:table-header-group}
img{max-width:100%!important}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css">
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{font-weight: normal}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#00}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.4.0/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</head>
<body class="book toc2 toc-right">
<div id="header">
<h1>Maritime Cloud Developer Guide 0.3-RC1</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#a-bit-of-history">1.1. A Bit of History</a></li>
<li><a href="#overview">1.2. Overview</a></li>
<li><a href="#organization-of-this-guide">1.3. Organization of this guide</a></li>
<li><a href="#feedback">1.4. Feedback</a></li>
</ul>
</li>
<li><a href="#connecting-to-a-mms-server">2. Connecting to a MMS server</a>
<ul class="sectlevel2">
<li><a href="#installing-the-client">2.1. Installing the client</a></li>
<li><a href="#identity">2.2. Identity</a></li>
<li><a href="#positionreader">2.3. PositionReader</a></li>
<li><a href="#connecting-and-disconnecting">2.4. Connecting and Disconnecting</a></li>
<li><a href="#connection-status">2.5. Connection status</a></li>
</ul>
</li>
<li><a href="#mms-and-services">3. MMS and Services</a>
<ul class="sectlevel2">
<li><a href="#endpoint-definition">3.1. Endpoint Definition</a></li>
<li><a href="#a-simple-example">3.2. A simple example</a></li>
<li><a href="#service-discovery">3.3. Service Discovery</a></li>
</ul>
</li>
<li><a href="#geocasting">4. Geocasting</a>
<ul class="sectlevel2">
<li><a href="#sending-and-listening-for-broadcasts">4.1. Sending and Listening for broadcasts</a></li>
<li><a href="#unicast-and-multicast">4.2. Unicast and multicast</a></li>
</ul>
</li>
<li><a href="#msdl">5. MSDL</a>
<ul class="sectlevel2">
<li><a href="#types">5.1. Types</a></li>
<li><a href="#enums">5.2. Enums</a></li>
<li><a href="#message">5.3. Message</a></li>
<li><a href="#containers">5.4. Containers</a></li>
<li><a href="#endpoints">5.5. Endpoints</a></li>
<li><a href="#comments">5.6. Comments</a></li>
<li><a href="#namespaces">5.7. Namespaces</a></li>
<li><a href="#imports">5.8. Imports</a></li>
<li><a href="#serialization-of-messages">5.9. Serialization of messages</a></li>
</ul>
</li>
<li><a href="#creating-new-services">6. Creating new services</a>
<ul class="sectlevel2">
<li><a href="#example">6.1. Example</a></li>
<li><a href="#running-and-building-the-examples">6.2. Running and building the examples</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="introduction"><a class="anchor" href="#introduction"></a>1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This development guide describes the current state of the Maritime Cloud reference implementation as of May 2015. Detailing the upcoming 0.3 release.
This version is still under development. And the API described in this document might change before the release.</p>
</div>
<div class="paragraph">
<p>Please do not email us directly about usage questions. Instead use our Google Group at <a href="https://groups.google.com/forum/#!forum/maritimecloud" class="bare">https://groups.google.com/forum/#!forum/maritimecloud</a> for general usage questions. In this way future users can see answers to commonly asked questions. Google Groups is also where we post information about new releases and updated documentation.</p>
</div>
<div class="paragraph">
<p>This developer guide is intended to make you familiar with developing applications and services for the Maritime Cloud. In addition to this developer guide the javadoc at <a href="http://dev.maritimecloud.net/apidocs/" class="bare">http://dev.maritimecloud.net/apidocs/</a> might come in handy for those using the Java Client.</p>
</div>
<div class="paragraph">
<p>Some experience with developing for the Java platform is required for using this development guide.
Developers should as minimum be able to write short single file Java programs. Some sections requires usage of the Apache Maven build tool.</p>
</div>
<div class="sect2">
<h3 id="a-bit-of-history"><a class="anchor" href="#a-bit-of-history"></a>1.1. A Bit of History</h3>
<div class="paragraph">
<p>The Maritime Cloud project started out as an internal project at the Danish Maritime Authority in the autumn of 2012.
As part of the e-Navigation process the Danish Maritime Authority had been working on an e-Navigation Prototype Display system called EPD. The EPD consist of two applications for demonstrating potential e-navigation solutions. An ECDIS like ship side application and a shore side application.</p>
</div>
<div class="paragraph">
<p>During the development it was clear that AIS was a severe limiting factor when communicating between the ship side and the shore side. Putting a lot of limitations of the different kind of maritime services that could be developed. Especially three issues was identified.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Lack of bandwidth.</strong> Only limited amounts of data could be transfered. Often using complex encoding schemes such as application specific AIS messages.</p>
</li>
<li>
<p><strong>Ease of development.</strong> There was no easy way to simulate AIS communication without a very complex developer environment.</p>
</li>
<li>
<p><strong>Limited Signal Coverage.</strong> There are certain types of services where the actors communicating might not all be within reach of radio signals.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first prototype was built in the winter of 2012 and was implemented in the EPD in spring 2013. It just featured basic point to point communication. This is basically what is the Maritime Message Service now. During the summer of 2013 the vision for a general framework for maritime communication was created. Including registries for services and identities in addition to the message based framework. It also got its name the “Maritime Cloud” as a sort of umbralle name for the various underlying services. In 2014 the first release of the Maritime Cloud reference implementation was made available for the public.</p>
</div>
</div>
<div class="sect2">
<h3 id="overview"><a class="anchor" href="#overview"></a>1.2. Overview</h3>
<div class="paragraph">
<p>Here is 10000 foot overview of the Maritime Cloud:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/maritimecloud.png" alt="Overview">
</div>
</div>
<div class="paragraph">
<p>There are 3 different core services provided by the Maritime Cloud</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Maritime Identity Registry.</strong> A centralized authority for identities of persons, organizations or ships that are using the Maritime Cloud.</p>
</li>
<li>
<p><strong>Maritime Service Registry.</strong> A centralized repository of service standards and provisioned services world wide.</p>
</li>
<li>
<p><strong>Maritime Messaging Service (MMS).</strong> A communication protocol on top of TCP/IP. Supporting reliable delivery of messages and geocasting<span class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnote_1" title="View footnote.">1</a>]</span>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Both the identity registry and service registry are still in the specification stage.
Only the Maritime Messaging Service (MMS) is functional. While functional, please note that the latest realease is still beta quality.</p>
</div>
<div class="paragraph">
<p>For more information on the Maritime Cloud concept see: <a href="http://maritimecloud.net" class="bare">http://maritimecloud.net</a></p>
</div>
<div class="sect3">
<h4 id="java-as-a-platform"><a class="anchor" href="#java-as-a-platform"></a>1.2.1. Java as a platform</h4>
<div class="paragraph">
<p>As you will notice when getting started with the Maritime Cloud all the software we provide requires a JVM (Java 8 or later) to run. While we do want to develop a C&#43;&#43;/C# client at some point. We currently do major refactorings at every release. In order to avoid too much duplicated work we need to finalize the specification of the Maritime Cloud before we can target other platforms. We understand this will be a major issue for companies and organizations that are C&#43;&#43;/C# only. However, we do not have the resources to develop along multiple tracks at this point.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="organization-of-this-guide"><a class="anchor" href="#organization-of-this-guide"></a>1.3. Organization of this guide</h3>
<div class="paragraph">
<p>Chapter 2 shows how to connect to an MMS Server.</p>
</div>
<div class="paragraph">
<p>Chapter 3 describes how to implement and invoke predefined remote services.</p>
</div>
<div class="paragraph">
<p>Chapter 4 describes how messages can be broadcast to a subset of actors within a specific area.</p>
</div>
<div class="paragraph">
<p>Chapter 5 specifies the Maritime Service Definition Language. Which is the language for defining services that can be registered with a MMS Server.</p>
</div>
<div class="paragraph">
<p>Chapter 6 describes how you can develop your own services with MSDL.</p>
</div>
</div>
<div class="sect2">
<h3 id="feedback"><a class="anchor" href="#feedback"></a>1.4. Feedback</h3>
<div class="paragraph">
<p>Readers may send feedback about errors, omissions, and ambiguities in this guide to <a href="mailto:kasperni@gmail.com">kasperni@gmail.com</a> or even better submit a pull request to the documentation available at <a href="https://github.com/MaritimeCloud/Documentation/tree/master/developer-guide/adoc" class="bare">https://github.com/MaritimeCloud/Documentation/tree/master/developer-guide/adoc</a>.</p>
</div>
<div class="paragraph">
<p>As previously mentioned questions about usage of the Maritime Cloud should be directed to our Google Group at <a href="https://groups.google.com/forum/#!forum/maritimecloud" class="bare">https://groups.google.com/forum/#!forum/maritimecloud</a></p>
</div>
<div class="sect3">
<h4 id="open-source-and-source-code"><a class="anchor" href="#open-source-and-source-code"></a>1.4.1. Open Source and Source code</h4>
<div class="paragraph">
<p>The source code of the Maritime Cloud reference implementation is available as open source at Github <a href="https://github.com/MaritimeCloud" class="bare">https://github.com/MaritimeCloud</a> under the Apache 2.0 License.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="connecting-to-a-mms-server"><a class="anchor" href="#connecting-to-a-mms-server"></a>2. Connecting to a MMS server</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter details how you install the MMS client and use it to connect to a MMS server.
In the next chapter we go into details about how to communicate with other actors connected to the same MMS Server</p>
</div>
<div class="paragraph">
<p>The MMS protocol is an internet based protocol layered on top of TCP/IP and WebSockets. It requires a persistent connection to a central server in order to be able to receive messages from remote actors.</p>
</div>
<div class="paragraph">
<p>On of the main ideas behind the MMS protocol is that actors/clients never communicate directly. Instead all clients
must connect to a MMS server to communicate. To send a message from a <em>Ship A</em> to a <em>Ship B</em>. Ship A must send the message to the MMS server which will relay the message to Ship B.</p>
</div>
<div class="paragraph">
<p>There are a number of reasons for this design</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Security,</strong> if clients where to communicate directly. Every client would have to have some kind of server running with an open public port. Making them an potential target for hackers. Instead by requiring them to connect to a central server. Only the server needs to be secured properly.</p>
</li>
<li>
<p><strong>Availability,</strong> satellite connections are in general more unreliable than landbased connections.
It is not uncommon that connections comes and go. By having a central server that is always on. It can act as a sort of mailbox if a client looses its connection temporarily.</p>
</li>
<li>
<p><strong>Bandwidth,</strong> while creating a new TCP/IP connection is a lightway process. It still takes both time and bandwidth. With a central approach only a single connection needs to maintained. Furthermore, when laying a secure protocol such as TLS on top of it the connection bandwidth cost is even higher especially if all you need is sending a single message.</p>
</li>
<li>
<p><strong>Geocasting,</strong> one of the main functionalities of the MMS protocol is the ability to send messages to all actors in a certain area. A central server is needed to keep track of where everybody is to order for the system to determine who should receive a particular geocasted message. Making sure that no bandwidth is wasted by broadcasting information that clients have no need for.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="installing-the-client"><a class="anchor" href="#installing-the-client"></a>2.1. Installing the client</h3>
<div class="paragraph">
<p>First if you do not already have a Java 8 JDK on your machine you need to install one. Either from OpenJDK or from Oracle.</p>
</div>
<div class="paragraph">
<p>The MMS client is a single jar available at <a href="http://repo1.maven.org/maven2/net/maritimecloud/mms/mc-mms-client/0.3/mc-mms-client-0.3.jar" class="bare">http://repo1.maven.org/maven2/net/maritimecloud/mms/mc-mms-client/0.3/mc-mms-client-0.3.jar</a>. There are no other dependencies. Everything needed to connect to a MMS Server is embedded in the jar.</p>
</div>
<div class="paragraph">
<p>If you are using Maven (or a similar build system) you can use the following dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>net.maritimecloud.mms<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>mc-mms-client<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>0.3-RC1<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Since you are using a develop version (snapshot) you also need to add this to your pom.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;pluginRepositories&gt;</span>
  <span class="tag">&lt;pluginRepository&gt;</span>
    <span class="tag">&lt;id&gt;</span>sonatype.snapshots<span class="tag">&lt;/id&gt;</span>
    <span class="tag">&lt;url&gt;</span>https://oss.sonatype.org/content/repositories/snapshots/<span class="tag">&lt;/url&gt;</span>
    <span class="tag">&lt;snapshots&gt;</span><span class="tag">&lt;enabled&gt;</span>true<span class="tag">&lt;/enabled&gt;</span><span class="tag">&lt;/snapshots&gt;</span>
    <span class="tag">&lt;releases&gt;</span><span class="tag">&lt;enabled&gt;</span>false<span class="tag">&lt;/enabled&gt;</span><span class="tag">&lt;/releases&gt;</span>
  <span class="tag">&lt;/pluginRepository&gt;</span>
<span class="tag">&lt;/pluginRepositories&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you are using the MMS client in a Java EE 7 (or greater) server we have a special client that uses functionality whereever possible of the Jave EE server. Just replace <em>mc-mms-client</em> with <em>mc-mms-client-javaee</em> in the above URL/dependency.</p>
</div>
</div>
<div class="sect2">
<h3 id="identity"><a class="anchor" href="#identity"></a>2.2. Identity</h3>
<div class="paragraph">
<p>The first thing you need to do before connecting to a MMS server is to create a MaritimeId which is your unique identity. Think of it as your user name. At some point the identity will be maintained in a registry for all stakeholders. But since the Maritime Identity Registry is still being specified we are using a temporary solution for now.</p>
</div>
<div class="paragraph">
<p>Any client connecting must use an integer identifier as their username. If you are emulating a ship you should use its 9 digit MMSI number. Otherwise you are free to choose the id. You should probably stay away for using numbers with 1-4 digits. Because if an client connects to a MMS server with an identical ID to one that is already connected. The client that is already connected is automatically disconnected. We use 0123456789 in most examples but you will want to replace it with your own id.</p>
</div>
<div class="paragraph">
<p>For various historic reasons the number must be prefixed with "mmsi:".</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
  MmsClientConfiguration conf = MmsClientConfiguration.create();
  MaritimeId id = MaritimeId.create(<span class="string"><span class="delimiter">&quot;</span><span class="content">mmsi:123456789</span><span class="delimiter">&quot;</span></span>);
  conf.setId(id);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above example shows how to create a MaritimeId. It also shows a MMSClientConfiguration object being created. This configuration is used to set various properties, for example, the host name of the MMS server before connecting.</p>
</div>
<div class="paragraph">
<p>While not required, we would appreciate if you set some details about the client that is connecting.
These are not required, but they are used by the Maritime Cloud development team to see who is connected to the cloud.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">conf.properties().setName(<span class="string"><span class="delimiter">&quot;</span><span class="content">MobyDick</span><span class="delimiter">&quot;</span></span>);
conf.properties().setOrganization(<span class="string"><span class="delimiter">&quot;</span><span class="content">Danish Maritime Authority</span><span class="delimiter">&quot;</span></span>);
conf.properties().setDescription(<span class="string"><span class="delimiter">&quot;</span><span class="content">A fictiv vessel used in the Mona Lisa 2 project</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="positionreader"><a class="anchor" href="#positionreader"></a>2.3. PositionReader</h3>
<div class="paragraph">
<p>One of the main features of the Maritime Cloud is support for geographical services. To use these services you need to let the MMS server know your current position. This is done by specifying a position reader that the MMS client can query for the current position.</p>
</div>
<div class="paragraph">
<p>Here is a simple reader that returns a fixed position at (latitude, longitude) (10,20).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">PositionReader staticReader = <span class="keyword">new</span> PositionReader() {
    <span class="directive">public</span> PositionTime getCurrentPosition() {
        <span class="keyword">return</span> PositionTime.create(<span class="integer">10</span>, <span class="integer">20</span>, <span class="predefined-type">System</span>.currentTimeMillis());
    }
};
conf.setPositionReader(staticReader);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Fixed locations are relevant for non-mobile actors like shore centers and servers providing services. For some actors the location is not relevant at all.</p>
</div>
<div class="paragraph">
<p>For mobile actors like ships, instead of just returning a fixed position you want to replace it with your own implementation that reads from whatever navigational equipment (for example, GPS) that is available. The timestamp of the position returned must be a timestamp from the time of measurement of the returned position.</p>
</div>
<div class="paragraph">
<p>If you are in an environment where you do not have access to real time positions and want to test mobility. You can use a PositionSimulator to create a fictive dynamic position.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">PositionReader simulatedReader = <span class="keyword">new</span> PositionReaderSimulator().setSpeedVariable(<span class="integer">10</span>, <span class="integer">30</span>, SpeedUnit.KNOTS).forArea(Circle.create(<span class="integer">55</span>, <span class="integer">55</span>, <span class="integer">1</span>));

conf.setPositionReader(simulatedReader);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The simulated position reader created in the above example will just sail around in a fixed circle
with a speed between 10 and 30 knots until disconnected.</p>
</div>
</div>
<div class="sect2">
<h3 id="connecting-and-disconnecting"><a class="anchor" href="#connecting-and-disconnecting"></a>2.4. Connecting and Disconnecting</h3>
<div class="paragraph">
<p>Every MMS clients needs to connect to a central MMS server. If you do not explicit specify a server when creating the client.
The client will automatically use the shared sandbox environment.</p>
</div>
<div class="paragraph">
<p>We provide 2 public environments that can be used by any client.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Sandbox,</strong> The <em>Sandbox</em> environment is meant for any kind of testing. For example, running tests with other organizations.</p>
</li>
<li>
<p><strong>Test,</strong> The <em>Test</em> environment is the closest environment that comes close to something that can be considered operational ready. The environment is called test even though people will be using for semi-operational usage. Simple because we do not have the resources to have a human monitor it 24/7. We we do have software that monitors it 24/7 and raises an alarm in case the environment is unresponsive.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Per default we always encrypt the data that is being sent back and forth. However, we provide a non-encrypted alternative with the sandbox environment in case you are having problems that needs an unencrypted connection.</p>
</div>
<div class="paragraph">
<p>So too specify which of the diffent environments you want to use. You can use one of these methods. Again, if you just want to use the sandbox environment you do not need to specify anything. As it is the default environment.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="comment">// If you want to use the sandbox environment use one of these</span>
    conf.setHost(Environment.SANDBOX);
    conf.setHost(Environment.SANDBOX_UNENCRYPTED);

    <span class="comment">// If you want to use the test environment use this</span>
    conf.setHost(Environment.TEST);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Instead up using the public instances we provide. You can also setup your own internal environment (which is easy, see later section).</p>
</div>
<div class="paragraph">
<p>If you repeatedly fail to connect make sure you are not behind any kind of firewall by telnetting to the MMS server "telnet mms.sandbox03.maritimecloud.net 80". If you keep having problems ask for help in our Google Group.</p>
</div>
<div class="paragraph">
<p>The last thing you need to do is to create the MMSClient which you will use to send and receive remote messages. When you create the client it will automatically (in the background) connect to the MMS server.
The full source of the example will also print out "success" when it
has successfully connected. And finally close/shutdown the client as the last thing.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">java.util.concurrent.TimeUnit</span>;

<span class="keyword">import</span> <span class="include">net.maritimecloud.core.id.MaritimeId</span>;
<span class="keyword">import</span> <span class="include">net.maritimecloud.net.mms.MmsClient</span>;
<span class="keyword">import</span> <span class="include">net.maritimecloud.net.mms.MmsClientConfiguration</span>;
<span class="keyword">import</span> <span class="include">net.maritimecloud.util.geometry.PositionReader</span>;
<span class="keyword">import</span> <span class="include">net.maritimecloud.util.geometry.PositionTime</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">MMSConnect</span> {
  <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) <span class="directive">throws</span> <span class="exception">Exception</span> {
    MmsClientConfiguration conf = MmsClientConfiguration.create();

    MaritimeId id = MaritimeId.create(<span class="string"><span class="delimiter">&quot;</span><span class="content">mmsi:123456789</span><span class="delimiter">&quot;</span></span>);
    conf.setId(id);

    conf.properties().setName(<span class="string"><span class="delimiter">&quot;</span><span class="content">MobyDick</span><span class="delimiter">&quot;</span></span>);
    conf.properties().setOrganization(<span class="string"><span class="delimiter">&quot;</span><span class="content">Danish Maritime Authority</span><span class="delimiter">&quot;</span></span>);
    conf.properties().setDescription(<span class="string"><span class="delimiter">&quot;</span><span class="content">A fictiv vessel used in the Mona Lisa 2 project</span><span class="delimiter">&quot;</span></span>);

    conf.setPositionReader(<span class="keyword">new</span> PositionReader() {
      <span class="directive">public</span> PositionTime getCurrentPosition() {
        <span class="keyword">return</span> PositionTime.create(<span class="integer">10</span>, <span class="integer">20</span>, <span class="predefined-type">System</span>.currentTimeMillis());
      }
    });

    MmsClient client = conf.build();

    <span class="comment">// Wait for a connection for 10 seconds</span>
    <span class="keyword">if</span> (client.connection().awaitConnected(<span class="integer">10</span>, <span class="predefined-type">TimeUnit</span>.SECONDS)) {
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Succesfully connected to the MaritimeCloud test server</span><span class="delimiter">&quot;</span></span>);
    } <span class="keyword">else</span> {
      <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Sorry, could not connect to the MaritimeCloud test server</span><span class="delimiter">&quot;</span></span>);
    }

    <span class="comment">//Disconnect</span>
    client.shutdown();
    client.awaitTermination(<span class="integer">10</span>, <span class="predefined-type">TimeUnit</span>.SECONDS);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you are using the public sandbox instance of the MMS Server. Your client should appear in the list of connected clients at this site <a href="http://mms.sandbox03.maritimecloud.net:9990/clients/list/" class="bare">http://mms.sandbox03.maritimecloud.net:9990/clients/list/</a>. The url basically lists all clients that are connected or have recently been connected. And is primarily used for debugging.</p>
</div>
<div class="paragraph">
<p>You should always remember to shutdown the client properly. This is mainly done to make sure that all messages that you have send have been properly delivered to the MMS Server.</p>
</div>
<div class="paragraph">
<p>Just as connecting was done asynchronously. Shutdown of the client is also done asynchronous.
So after having performed the shutdown you need to await for the client to have fully shutdown the connection to the MMS server.</p>
</div>
</div>
<div class="sect2">
<h3 id="connection-status"><a class="anchor" href="#connection-status"></a>2.5. Connection status</h3>
<div class="paragraph">
<p>While the MMS client will automatically connect and reconnect whenever a connection is lost. It is sometimes
useful to be able to query the actual state of the connection. This is easily done</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Is connected = </span><span class="delimiter">&quot;</span></span> + client.connection().isConnected());</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also manually disable and enable the connection to the MMS server. When you disable the connection it will automatically close the connection.
You can then at later point reenable it again.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">client.connection().disable();
<span class="comment">// Now lets reconnect again</span>
client.connection().enable();</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also block the current thread if you want to wait on a connection being connected or disconnected.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">client.connection().disable();
<span class="comment">//Now lets wait up to ten seconds for a fully disconnect</span>
client.connection().awaitDisconnected(<span class="integer">10</span>, <span class="predefined-type">TimeUnit</span>.SECONDS);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, before creating a MMSClient you can register a listener that will be invoked every time the status of the connection is changed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">MmsClientConfiguration conf = MmsClientConfiguration.create();
conf.addListener(<span class="keyword">new</span> MmsConnection.Listener() {
  <span class="directive">public</span> <span class="type">void</span> connecting(<span class="predefined-type">URI</span> host) {
    <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Trying to connect to </span><span class="delimiter">&quot;</span></span> + host);
  }

  <span class="directive">public</span> <span class="type">void</span> connected(<span class="predefined-type">URI</span> host) {
    <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Connected</span><span class="delimiter">&quot;</span></span>);
  }

  <span class="directive">public</span> <span class="type">void</span> disconnected(MmsConnectionClosingCode closeReason) {
    <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Disconnected </span><span class="delimiter">&quot;</span></span> + closeReason);
  }
});</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mms-and-services"><a class="anchor" href="#mms-and-services"></a>3. MMS and Services</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter outlines how you can invoke and register services/endpoints using the Maritime Messaging Service. Since we use the word service in many situations with regards to the Maritime Cloud. We refer to services exposed via MMS as MMS endpoints or sometimes just endpoints.</p>
</div>
<div class="paragraph">
<p>MMS endpoints are similar to web services. Basically an endpoint is just a method for communicating between two electronic devices over a network. Normally there is two parties involved in the exchange of data using a Web Service. A <em>Service Provider</em> who <strong>implements</strong> a service that can be invoked by others. And a <em>Service Consumer</em> who <strong>uses</strong> implementations provided by Service Providers.</p>
</div>
<div class="paragraph">
<p>When using the Maritime Messaging Service things are a little bit different. Instead of the service provider communicating directly with the service consumer. The MMS serve acts as a relay between the two parties as described by this diagram:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/service-consumer-provider.png" alt="service consumer provider" width="661" height="216">
</div>
</div>
<div class="sect2">
<h3 id="endpoint-definition"><a class="anchor" href="#endpoint-definition"></a>3.1. Endpoint Definition</h3>
<div class="paragraph">
<p>Normally, the definition of an endpoint is defined in a MSDL file. This file is then used to generate source code stubs that must be implemented by the party implementing the API of the endpoint. But for the following couple of examples we have already generated the stubs. So all you need to do use the following examples is to download the example jar and add it to your classpath. In later chapters we will see how you can write MSDL with your own endpoints.</p>
</div>
<div class="paragraph">
<p>The example jar available her <a href="http://repo1.maven.org/maven2/net/maritimecloud/examples/developer-guide/0.2/developer-guide-0.2.jar" class="bare">http://repo1.maven.org/maven2/net/maritimecloud/examples/developer-guide/0.2/developer-guide-0.2.jar</a>.</p>
</div>
<div class="paragraph">
<p>If you are using Maven (or a similar build system) you can use the following dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>net.maritimecloud.examples<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>developer-guide<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>0.3-RC1<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="a-simple-example"><a class="anchor" href="#a-simple-example"></a>3.2. A simple example</h3>
<div class="paragraph">
<p>In the following sections we will be using a very simple endpoint to demonstrate how endpoints can be used with the Maritime Messaging Service.</p>
</div>
<div class="paragraph">
<p>Our endpoint is very simple. It is just a single method that takes two integers and returns the sum of the two integers. Not something you would ever use a remote service for, but for demonstration purposes it will do just fine. Without going into detail about the syntax, here is the definition of the endpoint in MSDL.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="asciidoc">namespace maritimecloud.examples;

endpoint MathEndpoint {
  /* Returns the sum of the two specified integer. */
  int sum(1:int left, 2:int right);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Endpoint definitions in MSDL are pretty similar to interface definitions in Java or C++ semantically wise. However the syntax is a bit different.</p>
</div>
<div class="paragraph">
<p>The example jar you have downloaded already contains the stubs that was generated by MSDL code generator. For each endpoint two java stub files are generated. In this case an abstract class called <em>maritimecloud.examples.AbstractMathEndpoint</em> which the service provider must extend. And an interface called <em>maritimecloud.examples.MathEndpoint</em> which the service consumer uses to invoke methods on the remote endpoint.</p>
</div>
<div class="sect3">
<h4 id="service-provider"><a class="anchor" href="#service-provider"></a>3.2.1. Service Provider</h4>
<div class="paragraph">
<p>Let us first look at the service provider who implements the functionality of the endpoint.</p>
</div>
<div class="paragraph">
<p>As previously mentioned we need to extend a class called AbstractMathEndpoint which was generated from a MSDL file. All methods of the endpoint are abstract methods that must be implemented. Besides the actual parameters to the endpoint. Each endpoint method also takes a <em>context</em> object. This context can be used to query information about who is invoking the service. And what position there where at when invoking the service.</p>
</div>
<div class="paragraph">
<p>Our provider is really simple we just need to add two integers given. But in addition to the actual summation our implementation also prints out the two numbers and the id of the remote client that invoked the method.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">net.maritimecloud.net.MessageHeader</span>;
<span class="keyword">import</span> <span class="include">maritimecloud.examples.AbstractMathEndpoint</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">MathEndpointImplementation</span> <span class="directive">extends</span> AbstractMathEndpoint{
  <span class="directive">protected</span> <span class="predefined-type">Integer</span> sum(MessageHeader h, <span class="predefined-type">Integer</span> left, <span class="predefined-type">Integer</span> right) {
    <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Trying to sum </span><span class="delimiter">&quot;</span></span> + left + <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span> + right + <span class="string"><span class="delimiter">&quot;</span><span class="content"> for </span><span class="delimiter">&quot;</span></span> + h.getSender());
    <span class="keyword">return</span> left + right;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We also need to register the implementation with a MMS Server so remote clients can find and invoke methods on the endpoint.</p>
</div>
<div class="paragraph">
<p>Here is the full example of the Service Provider. For simplicity we have just embedded the actual endpoint implementation from the previous example as an anonymous class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">maritimecloud.examples.AbstractMathEndpoint</span>;
<span class="keyword">import</span> <span class="include">net.maritimecloud.net.MessageHeader</span>;
<span class="keyword">import</span> <span class="include">net.maritimecloud.net.mms.MmsClient</span>;
<span class="keyword">import</span> <span class="include">net.maritimecloud.net.mms.MmsClientConfiguration</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">ServiceProvider</span> {
  <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) <span class="directive">throws</span> <span class="exception">Exception</span> {
    MmsClient c = MmsClientConfiguration.create(<span class="string"><span class="delimiter">&quot;</span><span class="content">mmsi:1112222</span><span class="delimiter">&quot;</span></span>).build();

    c.endpointRegister(<span class="keyword">new</span> AbstractMathEndpoint() {
      <span class="directive">protected</span> <span class="predefined-type">Integer</span> sum(MessageHeader h, <span class="predefined-type">Integer</span> left, <span class="predefined-type">Integer</span> right) {
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Trying to sum </span><span class="delimiter">&quot;</span></span> + left + <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span> + right + <span class="string"><span class="delimiter">&quot;</span><span class="content"> for </span><span class="delimiter">&quot;</span></span> + h.getSender());
        <span class="keyword">return</span> left + right;
      }
    });

    <span class="predefined-type">Thread</span>.sleep(<span class="integer">1000000</span>);
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you run the above code. Anyone connected to the same MMS server will now be able to use your service. The next section shows how to do this.</p>
</div>
</div>
<div class="sect3">
<h4 id="service-consumer"><a class="anchor" href="#service-consumer"></a>3.2.2. Service Consumer</h4>
<div class="paragraph">
<p>To access a remote endpoint you must use an interface that is generated from a MSDL file.</p>
</div>
<div class="paragraph">
<p>In this case the maritimecloud.examples.MathEndpoint interface. Assuming we know the remote id of the service provider. Invoking the remote <em>sum</em> method is very easy. Just make sure the service provider defined in the previous section is still running.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">java.util.concurrent.TimeUnit</span>;

<span class="keyword">import</span> <span class="include">maritimecloud.examples.MathEndpoint</span>;
<span class="keyword">import</span> <span class="include">net.maritimecloud.core.id.MaritimeId</span>;
<span class="keyword">import</span> <span class="include">net.maritimecloud.net.EndpointInvocationFuture</span>;
<span class="keyword">import</span> <span class="include">net.maritimecloud.net.mms.MmsClient</span>;
<span class="keyword">import</span> <span class="include">net.maritimecloud.net.mms.MmsClientConfiguration</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">ServiceConsumer</span> {
  <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) <span class="directive">throws</span> <span class="exception">Exception</span> {
    MmsClient c = MmsClientConfiguration.create(<span class="string"><span class="delimiter">&quot;</span><span class="content">mmsi:2223333</span><span class="delimiter">&quot;</span></span>).build();

    MathEndpoint e = c.endpointCreate(MaritimeId.create(<span class="string"><span class="delimiter">&quot;</span><span class="content">mmsi:1112222</span><span class="delimiter">&quot;</span></span>), MathEndpoint.class);

    EndpointInvocationFuture&lt;<span class="predefined-type">Integer</span>&gt; sum = e.sum(<span class="integer">123</span>, <span class="integer">456</span>);
    <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content"> 123 + 456 = </span><span class="delimiter">&quot;</span></span> + sum.join());

    c.shutdown();
    c.awaitTermination(<span class="integer">1</span>, <span class="predefined-type">TimeUnit</span>.SECONDS);
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The example should be pretty self explanatory. However, the use of EndpointInvocationFuture might merit some explaining.</p>
</div>
<div class="paragraph">
<p>In our implementation of the Maritime Cloud every operation that might result in a network access is asynchronous.
That is the method/operation will return immediatly with a future that acts as a proxy for the result that is initially unknown.</p>
</div>
<div class="paragraph">
<p>In order to get the actual result of the operation you need to invoke <em>.join()</em> on the returned future. The interface is really simple now. But in future versions this interface will be extended with additional operations for blocking and asynchronous completion.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="service-discovery"><a class="anchor" href="#service-discovery"></a>3.3. Service Discovery</h3>
<div class="paragraph">
<p>Sometimes we might not know the id of the service provider. For example, we want to find all service providers that provide a service in a certain area.</p>
</div>
<div class="paragraph">
<p>For example, the following code will find all actors that are within a 10 km radius exposing the MathEndpoint.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">EndpointInvocationFuture&lt;<span class="predefined-type">List</span>&lt;MathEndpoint&gt;&gt; endpoints = client.endpointLocate(MathEndpoint.class).withinDistanceOf(<span class="integer">10000</span>).findAll();
<span class="keyword">for</span> (MathEndpoint e : endpoints.join()) {
  <span class="predefined-type">System</span>.out.println(e.getRemoteId() + <span class="string"><span class="delimiter">&quot;</span><span class="content"> exposes service MathEndpoint</span><span class="delimiter">&quot;</span></span>);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>All actors must have a registered PositionReader.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="geocasting"><a class="anchor" href="#geocasting"></a>4. Geocasting</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Geocasting is delivery of information to a group of destinations in a network identified by their geographical locations. Sometimes we refer to geocasting as broadcasting.</p>
</div>
<div class="paragraph">
<p>For example, here is a party (red dot) that wishes to geocast a message to everyone located on the african continent.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/geocast.svg" alt="geocast">
</div>
</div>
<div class="paragraph">
<p>Geocasts can be very useful, for example, if you want to send a message to every ship that is in your proximite.</p>
</div>
<div class="paragraph">
<p>Instead of sending these messages directly to ships that are near. The actor send the message along to the MMS server with an indicating of the area in which this message should be delivered. This can be either a relative area, for example, send this message too all ships within a 20 km radius of the actor itself. Or an absolute area defined by a polygon.</p>
</div>
<div class="paragraph">
<p>The MMS server will then look at the position of every ship that is connected to the server. And relay the message only to those ships that are within the area that the actor specified.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/broadcast.png" alt="broadcast" width="661" height="216">
</div>
</div>
<div class="paragraph">
<p>Like endpoints, all messages that can be broadcast are defined in a MSDL file.
Here is a very simple broadcast message that just sends a UTF-8 string.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="asciidoc">namespace maritimecloud.examples;

broadcast Hello {
  /* Just a text message. */
  1: text msg;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A class called <em>maritimecloud.examples.Hello</em> corresponding to the above definition is available in the example jar.</p>
</div>
<div class="sect2">
<h3 id="sending-and-listening-for-broadcasts"><a class="anchor" href="#sending-and-listening-for-broadcasts"></a>4.1. Sending and Listening for broadcasts</h3>
<div class="paragraph">
<p>Before you can receive a broadcast you need to listen for it actively. This is done by registering a broadcast listener.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">client.broadcastSubscribe(Hello.class, (context, broadcast) -&gt; {
    <span class="predefined-type">System</span>.out.println(context.getSender() + <span class="string"><span class="delimiter">&quot;</span><span class="content"> sends </span><span class="delimiter">&quot;</span></span> + broadcast.getMsg());
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>In another client you can now send a broadcast to clients that are in the proximite:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Hello hello = <span class="keyword">new</span> Hello();
hello.setMsg(<span class="string"><span class="delimiter">&quot;</span><span class="content">HelloWorld</span><span class="delimiter">&quot;</span></span>);
client.broadcast(hello);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The default broadcast radius is 50 kilometers. That is every client which is closer than 50 kilometers to the client sending the broadcast will receive the broadcast.</p>
</div>
<div class="paragraph">
<p>You can also use the <em>withBroadcast</em> method to specify a custom radius. For example, the following code will only send the message in a 30 kilometer radius.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Hello hello = <span class="keyword">new</span> Hello();
hello.setMsg(<span class="string"><span class="delimiter">&quot;</span><span class="content">HelloWorld</span><span class="delimiter">&quot;</span></span>);
client.broadcast(hello, <span class="keyword">new</span> MmsBroadcastOptions().toArea(<span class="integer">30000</span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>Currently it is only possible to listen for geocasts covering own position. In later releases it will be possible to define a area to listen in. Messages sent to an area intersecting with this listening area will result in reception of the message. This is highly relevant for non-mobile actors like shore stations that will be able to listen in a defined area like VTS area.</p>
</div>
</div>
<div class="sect2">
<h3 id="unicast-and-multicast"><a class="anchor" href="#unicast-and-multicast"></a>4.2. Unicast and multicast</h3>
<div class="paragraph">
<p>Unicast to a single recipient and multicast to a number of recipients is currently not supported but will be implemented in later versions.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="msdl"><a class="anchor" href="#msdl"></a>5. MSDL</h2>
<div class="sectionbody">
<div class="paragraph">
<p>MSDL is an interface description language <span class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnote_2" title="View footnote.">2</a>]</span> or specification language used for describing the interface of a particular set of services in the Maritime Cloud. MSDL is to the Maritime Cloud what IDL is to Corba and what WSDL is to XML based web services.</p>
</div>
<div class="paragraph">
<p>In order to develop new services that can be used with the Maritime Messaging Service you need to specify the interfaces of the services in a MSDL file. But, even if you are just a consumer of existing services it is a good idea to learn the syntax. In order to understand the contract of the service you are using.</p>
</div>
<div class="paragraph">
<p>An MSDL file is just an ordinary text file with a standardized syntax. Just to give you an idea of what a MSDL file looks like. Here is an example used in the EPD developed at DMA for route exchange.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="asciidoc">namespace dma.route;

/** The heading of each leg. */
enum HeadingType {
    RHUMB_LINE = 1;
    GREAT_CIRCLE = 2;
}

/** A route leg. */
message Leg {
    /** The speed over ground in knots. */
    1: float speed;

    /** Cross track starboard distance in meters. */
    2: float xtdStarboard;

    /** Cross track port distance in meters. */
    3: float xtdPort;

    /** The heading of the leg. */
    4: HeadingType headingType;

    /** The length of the navigational window in meters. */
    5: float navWindow;
}

/** A waypoint in a route. */
message Waypoint {

    /** The position. */
    1: position waypointPosition;

    /** The planned or estimated time of arrival at the waypoint position. */
    2: timestamp eta;

    /** The rate of turn of the waypoint. In degrees */
    3: float rot;

    /** The turn radius of the vessel. In nautical miles. */
    4: float turnRadius;

    /** The waypoints outleg, will be null for the final waypoint. */
    5: Leg outleg;
}

/** Route. */
message Route {
    /** A list of waypoints on the route . */
    1: list&lt;Waypoint&gt; waypoints;
    2: text routename;
}


/** Status of the Route Suggestion. */
enum RouteSuggestionStatus {
    PENDING = 1;
    ACCEPTED = 2;
    REJECTED = 3;
}

endpoint TacticalRouteEndpoint {

  void RouteSuggestion(
    /** The suggested route */
    1: Route route;

    /** The transaction ID */
    2: int64 id;

    /** The status, used for replying*/
    3: RouteSuggestionStatus status;
  );
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The syntax of MSDL is inspired by Apache Thrift, a remote procedure call (RPC) framework developed at Facebook.
While the main underlying binary serialization format is inspired by the binary wire format used by Protocol Buffers, developed at Google. If you have been using any of those 2 projects you should feel right at home when using MSDL.</p>
</div>
<div class="paragraph">
<p>Here is a rough sketch of how MSDL fits into the bigger picture.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/msdl.png" alt="msdl" width="740" height="378">
</div>
</div>
<div class="paragraph">
<p>The basic idea is that a single text based MSDL file is created for a service. This file is then distributed to all clients that wish to use this service. These clients then generates stubs that matches the definition from the MSDL file. These stubs then know how to serialize and deserialize to and from byte streams which can be transported over various protocols such as NAVDAT, VDES or MMS. Or even as an application specific message (AIS ASM).</p>
</div>
<div class="paragraph">
<p>The serialization mechanism is pluggable. So far we have developed a mechanism for serialization messages as JSON. But the next version (0.3) will include a compact binary serialization mechanism as well.</p>
</div>
<div class="paragraph">
<p>This following sections in this chapter describes the syntax of MSDL.</p>
</div>
<div class="sect2">
<h3 id="types"><a class="anchor" href="#types"></a>5.1. Types</h3>
<div class="paragraph">
<p>The MSDL type system consists of pre-defined base types, user-defined structs and container types.
Built-in data types are always all lowercase such as <em>float</em>. Custom defined datatypes always starts with a capital letter such as a <em>Waypoint</em> or a "TacticalRoute".</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 17%;">
<col style="width: 41%;">
<col style="width: 41%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Java type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">True or False</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.Boolean</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">binary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Arbitrary bytes (no validation)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">net.maritimecloud.util.Binary</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">decimal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Arbitrary-precision decimal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.math.BigDecimal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64-bit IEEE-754 floating point</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.Double</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32-bit IEEE-754 floating point</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.Float</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32-bit signed integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.Integer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64-bit signed integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.Long</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">list</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ordered collection of one or more elements</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.util.List</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">position</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Latitude+Longitude</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">net.maritimecloud.util.geometry.Position</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">positiontime</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">position + timestamp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">net.maritimecloud.util.geometry.PositionTime</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">set</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Collection of one or more unique elements</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.util.Set</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UTF-8 encoded string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">timestamp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date plus time since epoch (64-bit)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">net.maritimecloud.util.Timestamp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">varint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Arbitrary-precision integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.math.BigInteger</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>There are no support for unsigned integers as they are not supported on all platforms (well we only have one so far).</p>
</div>
</div>
<div class="sect2">
<h3 id="enums"><a class="anchor" href="#enums"></a>5.2. Enums</h3>
<div class="paragraph">
<p>When you’re defining a message type, you might want one of its fields to only have one of a pre-defined list of values. You can do this very simply by adding an enum to your message definition — An enum (also called enumeration or enumerated type) is a data type consisting of a set of named values called elements, members or enumerators of the type.</p>
</div>
<div class="paragraph">
<p>In the following example we have added an enum called Planet with all the different planets circling the sun:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="asciidoc">enum Planet {
    MERCURY = 1;
    VENUS   = 2;
    EARTH   = 3;
    MARS    = 4;
    JUPITER = 5;
    SATURN  = 6;
    URANUS  = 7;
    NEPTUNE = 8;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Enumerator constants MUST be in the range of <em>postive</em> 32-bit integers.</p>
</div>
</div>
<div class="sect2">
<h3 id="message"><a class="anchor" href="#message"></a>5.3. Message</h3>
<div class="paragraph">
<p>A message is the basic building block in a MSDL file. It is a collection of named fields with a specific type. Similar to how a table is defined in a database. Or a class in an object oriented language.</p>
</div>
<div class="paragraph">
<p>As you can see, each field in the message definition has a unique numbered tag. These tags are used to identify your fields in the wire format, and should not be changed once your message type is in use.</p>
</div>
<div class="paragraph">
<p>Messages do <strong>not</strong> support inheritance, that is, a message may not extend other message.
Instead composition should be used.</p>
</div>
<div class="paragraph">
<p>Here is the waypoint message we showed in the initial example of this chapter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="asciidoc">/** A waypoint in a route. */
message Waypoint {

    /** The position. */
    1: position waypointPosition;

    /** The planned or estimated time of arrival at the waypoint position. */
    2: timestamp eta;

    /** The rate of turn of the waypoint. In degrees */
    3: float rot;

    /** The turn radius of the vessel. In nautical miles. */
    4: float turnRadius;

    /** The waypoints outleg, will be null for the final waypoint. */
    5: Leg outleg;
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="containers"><a class="anchor" href="#containers"></a>5.4. Containers</h3>
<div class="paragraph">
<p>MSDL containers are strongly typed containers that map to the most commonly used containers in popular programming languages. They are annotated using the Java Generics style. There are currently two containers types available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>list&lt;t1&gt;:</strong> An ordered list of elements of type t1. May contain duplicates.</p>
</li>
<li>
<p><strong>set&lt;t1&gt;:</strong> An unordered set of unique elements of type t1.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, here is the definition of a polygon using the built-in type <em>position</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="asciidoc">message Polygon {
   1: list&lt;position&gt; points;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Types used in containers can be any valid type. For example, it is possible to defined containers of container such as <em>list&lt;set&lt;position&gt;&gt;</em>.</p>
</div>
<div class="paragraph">
<p>A map type is planned for future versions of MSDL.</p>
</div>
</div>
<div class="sect2">
<h3 id="endpoints"><a class="anchor" href="#endpoints"></a>5.5. Endpoints</h3>
<div class="paragraph">
<p>Think of endpoint definitions as Java interfaces. Endpoints contains multiple methods that each have a unique name and some kind og signature.</p>
</div>
<div class="paragraph">
<p>Here is real simple example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="asciidoc">endpoint ImageRender {
  binary render(1:text str);
  void sendResult(1:int64 id, 2:list&lt;int&gt; results);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Arguments can be primitive types or messages. Likewise for return types. <em>void</em> is a valid return type for functions.</p>
</div>
</div>
<div class="sect2">
<h3 id="comments"><a class="anchor" href="#comments"></a>5.6. Comments</h3>
<div class="paragraph">
<p>MSDL supports C-style multi-line as well as single-line Java/C++ style comments.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="asciidoc">/*
 * This is a multi-line comment.
 * Just like in Java or C.
 */

// C++/Java style single-line comments work just as well.</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="namespaces"><a class="anchor" href="#namespaces"></a>5.7. Namespaces</h3>
<div class="paragraph">
<p>Namespaces in MSDL are akin to namespaces in C++ or packages in Java — they offer a convenient way of organizing (or isolating) your code. Namespaces may also be used to prevent name clashes between type definitions.</p>
</div>
<div class="paragraph">
<p>While not enforced, MSDL files should be ordered in a namespace corresponding to the organization you are working with. For example, at the Danish Maritime Authorities we put all the MSDL files we develop into a "dma.<strong>*</strong>" namespace.</p>
</div>
<div class="paragraph">
<p>At some point we envision a global repository of MSDL files (Service Repository) where everyone can upload their MSDL files. Every organization is then responsible for maintaining their own MSDL files under their own namespace. Making it very easy for people to use the work of other organizations.</p>
</div>
</div>
<div class="sect2">
<h3 id="imports"><a class="anchor" href="#imports"></a>5.8. Imports</h3>
<div class="paragraph">
<p>It is often useful to split up MSDL definitions in separate files to ease maintenance, enable reuse and improve modularity/organization. MSDL allows files to include other MSDL files. Included files are looked up in the current directory and by searching relative to any paths specified when compiling.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="asciidoc">import &quot;dma/foobar.msdl&quot;;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="serialization-of-messages"><a class="anchor" href="#serialization-of-messages"></a>5.9. Serialization of messages</h3>
<div class="paragraph">
<p>Unlike, for example AIS. The serialization format of a message is not tightly coupled to the definition of the message. Instead general serialization protocols are implemented that anyone can use. These protocols take any kind of message and serializes it to a byte stream using predifined rules. In the other end an instance of the same serialization protocol takes the stream of bytes and transforms them into an equivalent message.</p>
</div>
<div class="paragraph">
<p>The current version comes with a JSON based protocol. So all messages that are send over the Maritime Cloud are JSON messages. In the future are highly compact binary protocol will be added.</p>
</div>
<div class="paragraph">
<p>We expect very few people to actually implement their own serialization protocol. And we will not cover how to do this in this developer guide. Instead look at how the existing JSON protocol is implemented.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-new-services"><a class="anchor" href="#creating-new-services"></a>6. Creating new services</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter details how you can use MSDL to develop new services that can be used over the Maritime Messaging Service.
At the moment we require usage of Apache Maven to generate Java stubs from MSDL files. But in the future we aim to provide a standalone compiler.</p>
</div>
<div class="sect2">
<h3 id="example"><a class="anchor" href="#example"></a>6.1. Example</h3>
<div class="paragraph">
<p>The following example will use a single pom.xml file, a MSDL file and two Java files.
The files created should follow this layout.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/chapter7-4files.png" alt="projectlayout">
</div>
</div>
<div class="paragraph">
<p>The example is taken from <a href="https://github.com/MaritimeCloud/Documentation/tree/master/developer-guide/maven-examples" class="bare">https://github.com/MaritimeCloud/Documentation/tree/master/developer-guide/maven-examples</a>
which you can clone instead of typing it out yourself.</p>
</div>
<div class="sect3">
<h4 id="pom-xml"><a class="anchor" href="#pom-xml"></a>6.1.1. pom.xml</h4>
<div class="paragraph">
<p>In order to use create the Java stubs using the MSDL compiler. You need to enable the MSDL maven plugin in your pom.xml file.
Here is an example of pom.xml that can be used as the basis. Notice the MDSL build plugin.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="tag">&lt;project</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://maven.apache.org/POM/4.0.0</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;modelVersion&gt;</span>4.0.0<span class="tag">&lt;/modelVersion&gt;</span>

  <span class="tag">&lt;groupId&gt;</span>your.group-id<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>your.artifact.id<span class="tag">&lt;/artifactId&gt;</span>
  <span class="tag">&lt;version&gt;</span>123<span class="tag">&lt;/version&gt;</span>

  <span class="tag">&lt;build&gt;</span>
    <span class="tag">&lt;plugins&gt;</span>
      <span class="tag">&lt;plugin&gt;</span>
        <span class="tag">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/groupId&gt;</span>
        <span class="tag">&lt;artifactId&gt;</span>maven-compiler-plugin<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;version&gt;</span>3.1<span class="tag">&lt;/version&gt;</span>
        <span class="tag">&lt;configuration&gt;</span>
          <span class="tag">&lt;source&gt;</span>1.8<span class="tag">&lt;/source&gt;</span>
          <span class="tag">&lt;target&gt;</span>1.8<span class="tag">&lt;/target&gt;</span>
          <span class="tag">&lt;encoding&gt;</span>UTF-8<span class="tag">&lt;/encoding&gt;</span>
          <span class="tag">&lt;optimize&gt;</span>false<span class="tag">&lt;/optimize&gt;</span>
          <span class="tag">&lt;debug&gt;</span>true<span class="tag">&lt;/debug&gt;</span>
          <span class="tag">&lt;showDeprecation&gt;</span>true<span class="tag">&lt;/showDeprecation&gt;</span>
        <span class="tag">&lt;/configuration&gt;</span>
      <span class="tag">&lt;/plugin&gt;</span>
      <span class="tag">&lt;plugin&gt;</span>
        <span class="tag">&lt;groupId&gt;</span>net.maritimecloud.msdl<span class="tag">&lt;/groupId&gt;</span>
        <span class="tag">&lt;artifactId&gt;</span>mc-msdl-maven-plugin<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;version&gt;</span>0.3-RC1<span class="tag">&lt;/version&gt;</span>
        <span class="tag">&lt;executions&gt;</span>
          <span class="tag">&lt;execution&gt;</span>
            <span class="tag">&lt;goals&gt;</span>
              <span class="tag">&lt;goal&gt;</span>compile<span class="tag">&lt;/goal&gt;</span>
            <span class="tag">&lt;/goals&gt;</span>
          <span class="tag">&lt;/execution&gt;</span>
        <span class="tag">&lt;/executions&gt;</span>
      <span class="tag">&lt;/plugin&gt;</span>
    <span class="tag">&lt;/plugins&gt;</span>
  <span class="tag">&lt;/build&gt;</span>

  <span class="tag">&lt;dependencies&gt;</span>
    <span class="tag">&lt;dependency&gt;</span>
      <span class="tag">&lt;groupId&gt;</span>net.maritimecloud.mms<span class="tag">&lt;/groupId&gt;</span>
      <span class="tag">&lt;artifactId&gt;</span>mc-mms-client-impl<span class="tag">&lt;/artifactId&gt;</span>
      <span class="tag">&lt;version&gt;</span>0.3-RC1<span class="tag">&lt;/version&gt;</span>
    <span class="tag">&lt;/dependency&gt;</span>
  <span class="tag">&lt;/dependencies&gt;</span>
<span class="tag">&lt;/project&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="msdl-file"><a class="anchor" href="#msdl-file"></a>6.1.2. MSDL file</h4>
<div class="paragraph">
<p>All MSDL files must be place in the <em>src/main/msdl</em> folder. Furthermore more they must be ordered by their namespace.
For example, a MSDL file with a namespace <em>org.acme</em> should be place in the <em>src/main/msdl/org/acme* folder</em></p>
</div>
<div class="paragraph">
<p>Save this MSDL as <em>src/main/msdl/maritimecloud/examples/examples.msdl</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre>namespace maritimecloud.examples;

endpoint MathEndpoint {
  int sum(1:int left, 2:int right);
}

broadcast Hello {
  1: text msg;
}

endpoint ImageRender {
  binary render(1:text str);
}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="java-files"><a class="anchor" href="#java-files"></a>6.1.3. Java files</h4>
<div class="paragraph">
<p>Before we generate the stubs let us add two classes that uses the stubs we generate</p>
</div>
<div class="paragraph">
<p>A client with a random Maritime ID that repeatable sends broadcasts:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">net.maritimecloud.example</span>;

<span class="keyword">import</span> <span class="include">java.util.Date</span>;
<span class="keyword">import</span> <span class="include">java.util.concurrent.ThreadLocalRandom</span>;

<span class="keyword">import</span> <span class="include">maritimecloud.examples.Hello</span>;
<span class="keyword">import</span> <span class="include">net.maritimecloud.core.id.MaritimeId</span>;
<span class="keyword">import</span> <span class="include">net.maritimecloud.net.mms.MmsClient</span>;
<span class="keyword">import</span> <span class="include">net.maritimecloud.net.mms.MmsClientConfiguration</span>;
<span class="keyword">import</span> <span class="include">net.maritimecloud.util.geometry.Position</span>;
<span class="keyword">import</span> <span class="include">net.maritimecloud.util.geometry.PositionReader</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">SendBroadcast</span> {

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) <span class="directive">throws</span> <span class="exception">Exception</span> {
        MmsClientConfiguration conf = MmsClientConfiguration.create();
        conf.setId(MaritimeId.create(<span class="string"><span class="delimiter">&quot;</span><span class="content">mmsi:</span><span class="delimiter">&quot;</span></span> + ThreadLocalRandom.current().nextLong(<span class="integer">10000</span>, <span class="integer">100000</span>)));
        conf.setPositionReader(PositionReader.fixedPosition(<span class="predefined-type">Position</span>.create(<span class="integer">1</span>, <span class="integer">1</span>)));
        conf.properties().setName(<span class="string"><span class="delimiter">&quot;</span><span class="content">MaritimeExampleGuide</span><span class="delimiter">&quot;</span></span>);
        MmsClient client = conf.build();
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Starting send client </span><span class="delimiter">&quot;</span></span> + conf.getId());
        <span class="keyword">for</span>(;;) {
            Hello hello = <span class="keyword">new</span> Hello();
            hello.setMsg(<span class="string"><span class="delimiter">&quot;</span><span class="content">HelloWorld</span><span class="delimiter">&quot;</span></span>);
            client.broadcast(<span class="keyword">new</span> Hello().setMsg(<span class="string"><span class="delimiter">&quot;</span><span class="content">HelloWorld</span><span class="delimiter">&quot;</span></span> + <span class="keyword">new</span> <span class="predefined-type">Date</span>()));
            <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Broadcast send</span><span class="delimiter">&quot;</span></span>);
            <span class="predefined-type">Thread</span>.sleep(<span class="integer">1000</span>);
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And a client that repeatable receives the broadcasts:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">net.maritimecloud.example</span>;

<span class="keyword">import</span> <span class="include">java.util.concurrent.ThreadLocalRandom</span>;
<span class="keyword">import</span> <span class="include">java.util.concurrent.TimeUnit</span>;

<span class="keyword">import</span> <span class="include">maritimecloud.examples.Hello</span>;
<span class="keyword">import</span> <span class="include">net.maritimecloud.core.id.MaritimeId</span>;
<span class="keyword">import</span> <span class="include">net.maritimecloud.net.mms.MmsClient</span>;
<span class="keyword">import</span> <span class="include">net.maritimecloud.net.mms.MmsClientConfiguration</span>;
<span class="keyword">import</span> <span class="include">net.maritimecloud.util.geometry.Position</span>;
<span class="keyword">import</span> <span class="include">net.maritimecloud.util.geometry.PositionReader</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">ReceiveBroadcast</span> {

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) <span class="directive">throws</span> <span class="exception">Exception</span> {
        MmsClientConfiguration conf = MmsClientConfiguration.create();
        conf.setId(MaritimeId.create(<span class="string"><span class="delimiter">&quot;</span><span class="content">mmsi:</span><span class="delimiter">&quot;</span></span> + ThreadLocalRandom.current().nextLong(<span class="integer">10000</span>, <span class="integer">100000</span>)));
        conf.setPositionReader(PositionReader.fixedPosition(<span class="predefined-type">Position</span>.create(<span class="integer">1</span>, <span class="integer">1</span>)));
        conf.properties().setName(<span class="string"><span class="delimiter">&quot;</span><span class="content">MaritimeExampleGuide</span><span class="delimiter">&quot;</span></span>);
        MmsClient client = conf.build();

        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Starting receive client </span><span class="delimiter">&quot;</span></span> + conf.getId());

        client.broadcastSubscribe(Hello.class,
                (con, e) -&gt; <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Received </span><span class="delimiter">&quot;</span></span> + e.getMsg() + <span class="string"><span class="delimiter">&quot;</span><span class="content"> from </span><span class="delimiter">&quot;</span></span> + con.getSender()));


        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Waiting for Hello broadcasts</span><span class="delimiter">&quot;</span></span>);
        <span class="predefined-type">Thread</span>.sleep(<span class="integer">100000</span>);
        client.shutdown();
        client.awaitTermination(<span class="integer">1</span>, <span class="predefined-type">TimeUnit</span>.SECONDS);
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="running-and-building-the-examples"><a class="anchor" href="#running-and-building-the-examples"></a>6.2. Running and building the examples</h3>
<div class="paragraph">
<p>You can generate the Java stubs by using the usual maven targets such as <em>compile</em>, <em>package</em> and <em>install</em>.
Generation of sources is attached to Maven&#8217;s <em>generate-sources</em> lifecycle as specified in <a href="http://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html" class="bare">http://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; mvn package</pre>
</div>
</div>
<div class="paragraph">
<p>If you inspect the output of the build you will see the following 5 generated java files.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/chapter7-generated.png" alt="projectlayout">
</div>
</div>
<div class="paragraph">
<p>Since <em>mvn package</em> also compiles your source code you can start the examples from the the command line.
Here we are using Maven&#8217;s <em>exec</em> plugin which makes it easy to put your dependencies on the classpath.</p>
</div>
<div class="paragraph">
<p>Start the client that broadcasts simple messages by using</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; mvn exec:java -Dexec.mainClass="net.maritimecloud.example.SendBroadcast"</pre>
</div>
</div>
<div class="paragraph">
<p>And a client that receives the broadcasts by using</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; mvn exec:java -Dexec.mainClass="net.maritimecloud.example.ReceiveBroadcast"</pre>
</div>
</div>
<div class="paragraph">
<p>You can put the jar file that you have just generated on the classpath in any project.
And use the stubs that was generated. This make it easy to have a single project that contains
all MSDL files and generated stubs. And the multiple projects that all references that project.</p>
</div>
<div class="paragraph">
<p>By following chapter 3 it should be easy to register your own endpoints as well.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnote_1">
<a href="#_footnoteref_1">1</a>. Geocasting refers to the delivery of information to a group of actors identified by their geographical locations.
</div>
<div class="footnote" id="_footnote_2">
<a href="#_footnoteref_2">2</a>. <a href="http://en.wikipedia.org/wiki/Interface_description_language" class="bare">http://en.wikipedia.org/wiki/Interface_description_language</a>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2015-05-12 15:39:11 ICT
</div>
</div>
</body>
</html>